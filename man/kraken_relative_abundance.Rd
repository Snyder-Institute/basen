% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/relative_abundance.R
\name{kraken_relative_abundance}
\alias{kraken_relative_abundance}
\title{Calculate species-level relative abundance from Kraken2 outputs}
\usage{
kraken_relative_abundance(
  report_dir = NULL,
  kraken_dir = NULL,
  k_mer_length = 35,
  genome_stats_file,
  sample_ids = NULL,
  output_folder = NULL,
  verbose = TRUE
)
}
\arguments{
\item{report_dir}{Directory containing *.report files. If NULL, kraken_dir
will be used.}

\item{kraken_dir}{Directory containing *.kraken files. If NULL, report_dir
will be used.}

\item{k_mer_length}{Positive integer specifying the k-mer length used by
Kraken2. This value is subtracted from genome_size_bp when computing
coverage proxies. Default is 35.}

\item{genome_stats_file}{Full path to genome stats file. The first column
must be taxid and the second column genome_size_bp.}

\item{sample_ids}{Optional character vector of sample IDs (file basenames)
to process. If NULL, all samples found in the directory are processed.}

\item{output_folder}{Optional directory to write per-sample result files.
If provided, one tab-delimited file named <sample_id>.basen is written
for each processed sample.}

\item{verbose}{Logical; print progress and sanity checks.}
}
\value{
A data.table with columns:
sample_id, name, taxid, genome_size_bp, bases_assigned,
reads_assigned, coverage_proxy, relative_abundance
}
\description{
Calculate species-level relative abundance from Kraken2 outputs
}
\examples{
## Example 1: Process all samples and return results only
result_in_list <- kraken_relative_abundance(
        report_dir = report_dir,
        genome_stats_file = genome_stats,
        verbose = TRUE
)

## Example 2: Process a subset of samples and export results
result_in_list <- kraken_relative_abundance(
        report_dir = report_dir,
        kraken_dir = kraken_dir,
        genome_stats_file = genome_stats,
        sample_ids = c("SampleA", "SampleB"),
        output_folder = "relative_abundance_results",
        verbose = TRUE
)
}
