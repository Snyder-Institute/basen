% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/relative_abundance.R
\name{calc_size_factors}
\alias{calc_size_factors}
\title{Calculate size factors from a coverage proxy matrix}
\usage{
calc_size_factors(x, method = c("median", "geomean"), verbose = TRUE)
}
\arguments{
\item{x}{A numeric matrix (or coercible to matrix) with taxids as rownames and
sample IDs as colnames. Cell values must be \code{coverage_proxy}.}

\item{method}{Character; one of \code{"median"} or \code{"geomean"}.}

\item{verbose}{Logical; print progress and sanity checks.}
}
\value{
A numeric vector of size factors named by sample (column) names.
}
\description{
This function calculates per-sample size factors from a coverage proxy matrix
(rows = taxids, columns = samples, values = \code{coverage_proxy}).
}
\details{
Important: size factors should be computed from \code{coverage_proxy} (a depth proxy),
not from \code{relative_abundance}. Relative abundance is compositional and does not
retain the total-depth information that size-factor scaling is designed to capture.

The implementation follows the standard "median ratio" family of methods:
\enumerate{
\item build a per-taxon reference across samples (geometric mean of coverage_proxy),
\item compute per-sample ratios (coverage_proxy / reference),
\item summarize ratios into a single size factor per sample via median or geomean.
}
}
\examples{
## x is a taxid-by-sample matrix of coverage_proxy values
## rownames(x) = taxids, colnames(x) = sample IDs
##
## sf <- calc_size_factors(x, method = "median")
## sf

## Optional: normalize coverage_proxy by size factors
## x_norm <- sweep(x, 2, sf, FUN = "/")
}
